# UJN-of-ISE---Basic-Programming-Course-C-Language-Project-Train-Ticket-Booking-Management-System  V2023.2036

Jinan University College of Information Science and Engineering Basic Programming (C Language) Course Project - Train Ticket Booking Management System, Author: Jiang Han, Class of 2023

这是一个基于 C 语言开发的简易火车订票系统，采用模块化设计，包含**动态密码生成器**、**管理员端**和**客户端**三个独立程序。系统支持列车信息的录入、查询、订票、退票以及数据持久化存储。

---

## 📂 文件结构说明

### 核心程序代码
*   **`code.cpp`** (动态密码生成器)
    *   **功能**: 生成一个包含随机字符的动态密码文件，用于管理员登录验证。
    *   **输出**: `code.txt`
*   **`manager.cpp`** (管理员系统)
    *   **功能**: 系统初始化工具。管理员登录后录入火车班次的基础信息。
    *   **输入**: `code.txt` (读取密码)
    *   **输出**: `information` (列车数据文件), `error recordings.txt` (错误日志)
*   **`2.1.cpp`** (客户端/用户系统 - 新版)
    *   **功能**: 面向用户的交互系统。提供查票、订票、退票及统计功能。
    *   **输入**: `information.dat` (列车数据), 各车次名称的数据文件 (如 `G101`)
    *   **输出**: 更新后的 `information.dat` 和各车次乘客数据文件

### 数据文件 (自动生成)
*   **`code.txt`**: 存储生成的 18 位随机动态密码。
*   **`information` / `information.dat`**: 二进制文件，存储 5 趟列车的详细信息（终点站、车次、时间、票价、余票）。
*   **`error recordings.txt`**: 文本文件，记录管理员登录失败的账号和时间。
*   **`[车次名]` (如 `K123`)**: 二进制文件，存储对应车次的乘客订票记录（姓名、身份证、票数）。

---

## 🚀 详细编译与运行指南

为了确保系统数据的正确流转，请务必**严格按照以下顺序**运行程序。

### 第一步：生成安全凭证
1.  使用编译器（推荐 VS Code 或 Dev-C++）打开并编译运行 **`code.cpp`**。
2.  程序运行结束后，当前目录下会自动生成 `code.txt`。
    *   *提示：您可以打开该文件复制密码，以便下一步使用。*

### 第二步：管理员初始化数据
1.  编译并运行 **`manager.cpp`**。
2.  **登录验证**:
    *   输入任意管理员账号。
    *   输入从 `code.txt` 中获取的动态密码。
    *   *注意：连续 3 次输入错误将锁定系统，并生成错误日志 `error recordings.txt`。*
3.  **录入信息**:
    *   系统会提示您依次录入 **5 趟** 列车的信息。
    *   **输入格式示例**:
        *   终点站: `Beijing`
        *   车次: `G101`
        *   发车时间 (年 月 日 时 分): `2023 10 1 08 30`
        *   车票数: `100`
        *   票价: `500.5`
4.  录入完成后，程序会生成名为 `information` 的文件并退出。

### 第三步：关键配置 (手动操作)
⚠️ **重要提示**: 管理员系统生成的列车数据文件名为 `information`，但用户系统默认读取的文件名为 `information.dat`。
*   **操作**: 请手动将当前目录下的 `information` 文件重命名为 **`information.dat`**。

### 第四步：启动用户订票系统
1.  编译并运行 **`2.1.cpp`** (推荐使用 Dev-C++ 以获得最佳兼容性)。
2.  系统启动后会显示所有列车信息列表。
3.  根据菜单提示输入数字选择功能：
    *   `1`: **查询线路** (支持按“终点站”或“车次”查询)
    *   `2`: **订票** (输入车次 -> 票数 -> 姓名 -> 身份证号)
    *   `3`: **退票** (输入车次 -> 身份证号 -> 退票数量)
    *   `4`: **其他功能** (查看乘客名单、余票统计、按日期查询等)
    *   `5`: **退出系统** (**重要**: 只有通过此选项退出，数据才会保存到硬盘)

---

## 🛠️ 功能模块详解

### 1. 管理员系统 (`manager.cpp`)
*   **安全机制**: 采用文件读取方式比对动态密码，增强安全性。
*   **日志审计**: 记录非法登录尝试的账号及时间戳。
*   **数据初始化**: 批量设置列车的初始状态，包括 `StartTime` (结构体) 和 `fare` (浮点数)。

### 2. 用户系统 (`2.1.cpp`)
*   **数据结构**:
    *   使用 **链表 (Linked List)** 管理每个车次的乘客信息，支持动态增加和删除。
    *   使用 **结构体数组** 存储列车时刻表。
*   **核心功能**:
    *   **智能订票**: 自动检查余票是否充足，计算总票价，并将新乘客节点插入链表尾部。
    *   **退票逻辑**: 根据身份证号查找乘客。支持**部分退票**（仅归还余票）和**全额退票**（删除乘客记录）。
    *   **多维查询**:
        *   按日期查询：输入 `2023 10 1` 可筛选当日所有班次。
        *   余票预警：一键列出所有已售罄（余票为0）的班次。
    *   **数据持久化**:
        *   程序启动时：自动加载 `information.dat` 及各车次对应的乘客数据文件。
        *   程序退出时：将内存中的链表数据和列车状态回写到磁盘，确保数据不丢失。

---

## 📝 开发与维护说明

*   **编译器兼容性**:
    *   `2.1.cpp` 包含部分旧式 C 语法风格，建议使用 **Dev-C++** 或在 GCC 中添加兼容性标志。
*   **数据重置**:
    *   如果需要清空所有数据重新开始，只需删除目录下生成的 `.dat` 文件、`code.txt` 以及无后缀的 `information` 文件，然后从“第一步”重新开始即可。
